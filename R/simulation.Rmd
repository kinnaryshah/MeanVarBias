```{r}

### GENERATING DATA

#1000 spots and 200 genes

  #150 genes will have sigma.sq = 0
  #50 genes will have sigma.sq randomly selected from a range 1 to 10 (this is ground truth of ranks)

  #all genes will have nonzero beta values

  #150 genes will have beta values randomly selected from a range 1 to 100
  #25 of the 50 genes will have beta values randomly selected from a range 1 to 10
  #25 of the 50 genes will have beta values randomly selected from a range 50 to 100

#choose fixed length scale parameter (mean of DLPFC length scale param across genes)

#sampling from a poisson distribution - mean controls variance, so we don't specify tau.sq:
#step 1: use ST example distance matrix instead of creating a new one (Euclidean distance)
#step 2: calculate gaussian process/kernel 
#step 3: calculate lambda = exp(beta + gaussian process)
#step 4: use rpois() to simulate 1000 values per gene

#create spe using counts and distances

### USING THE DATA

#create logcounts matrix

#run nnSVG on the logcounts matrix

#run weighted nnSVG on the logcounts matrix

### EXPLORING CHANGING RANKS
#prop sv, sigma.sq, LR pre weighting, LR post weighting, etc.

```

